{% extends "base.html" %}

{% block content %}
{# 
  Reusable UI Component Macros
  ===========================
  
  Usage examples:
  {{ Button("Save", variant="primary", href="/save") }}
  {{ Card("Title", "Content here", actions=[Button("Edit"), Button("Delete")]) }}
  {{ Stat("Active Jobs", "12", state="success") }}
  {{ Badge("Completed", tone="success") }}
  {{ Table(["Name", "Status"], [["John", "Active"], ["Jane", "Inactive"]]) }}
  {{ Field("Email", "user@example.com", name="email", type="email") }}
  {{ Section("Settings", [Button("Save")], "Settings content here") }}
#}

{# Button Component #}
{% macro Button(text, variant="primary", href=None, icon=None, size="md", disabled=False, onclick=None, class="", **kwargs) %}
  {% set base_classes = "inline-flex items-center gap-2 font-medium transition-all focus:outline-none focus:ring-2 focus:ring-offset-2" %}
  {% set size_classes = {
    "sm": "px-3 py-1.5 text-sm rounded-md",
    "md": "px-4 py-2 text-sm rounded-lg", 
    "lg": "px-6 py-3 text-base rounded-lg"
  } %}
  {% set variant_classes = {
    "primary": "bg-blue-600 hover:bg-blue-700 text-white focus:ring-blue-500",
    "secondary": "bg-gray-600 hover:bg-gray-700 text-white focus:ring-gray-500",
    "success": "bg-green-600 hover:bg-green-700 text-white focus:ring-green-500",
    "warning": "bg-yellow-600 hover:bg-yellow-700 text-white focus:ring-yellow-500",
    "danger": "bg-red-600 hover:bg-red-700 text-white focus:ring-red-500",
    "outline": "border border-gray-300 bg-transparent hover:bg-gray-50 text-gray-700 focus:ring-gray-500",
    "ghost": "bg-transparent hover:bg-gray-100 text-gray-700 focus:ring-gray-500"
  } %}
  
  {% set classes = [base_classes, size_classes[size], variant_classes[variant], class] | join(" ") %}
  {% set tag = "a" if href else "button" %}
  {% set attrs = [] %}
  {% if href %}{{ attrs.append('href="' + href + '"') }}{% endif %}
  {% if onclick %}{{ attrs.append('onclick="' + onclick + '"') }}{% endif %}
  {% if disabled %}{{ attrs.append('disabled') }}{% endif %}
  {% for key, value in kwargs.items() %}{{ attrs.append(key + '="' + value + '"') }}{% endfor %}
  
  <{{ tag }} class="{{ classes }}" {{ attrs | join(" ") }}>
    {% if icon %}<span class="w-4 h-4">{{ icon | safe }}</span>{% endif %}
    {{ text }}
  </{{ tag }}>
{% endmacro %}

{# Card Component #}
{% macro Card(title=None, body="", actions=None, class="", **kwargs) %}
  <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6 {{ class }}">
    {% if title %}
      <div class="flex items-center justify-between mb-4">
        <h3 class="text-lg font-semibold text-gray-900 dark:text-white">{{ title }}</h3>
        {% if actions %}
          <div class="flex items-center gap-2">
            {% for action in actions %}{{ action }}{% endfor %}
          </div>
        {% endif %}
      </div>
    {% endif %}
    <div class="text-gray-600 dark:text-gray-300">
      {{ body | safe }}
    </div>
  </div>
{% endmacro %}

{# Stat Component #}
{% macro Stat(label, value, hint=None, state="default", class="") %}
  {% set state_classes = {
    "default": "text-gray-900 dark:text-white",
    "success": "text-green-600 dark:text-green-400", 
    "warning": "text-yellow-600 dark:text-yellow-400",
    "danger": "text-red-600 dark:text-red-400",
    "info": "text-blue-600 dark:text-blue-400"
  } %}
  
  <div class="bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700 {{ class }}">
    <div class="text-sm font-medium text-gray-500 dark:text-gray-400">{{ label }}</div>
    <div class="text-2xl font-bold {{ state_classes[state] }}">{{ value }}</div>
    {% if hint %}<div class="text-xs text-gray-400 dark:text-gray-500 mt-1">{{ hint }}</div>{% endif %}
  </div>
{% endmacro %}

{# Badge Component #}
{% macro Badge(text, tone="muted", size="sm", class="") %}
  {% set size_classes = {
    "sm": "px-2 py-1 text-xs",
    "md": "px-3 py-1.5 text-sm",
    "lg": "px-4 py-2 text-base"
  } %}
  {% set tone_classes = {
    "muted": "bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",
    "success": "bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",
    "warning": "bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300", 
    "danger": "bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",
    "info": "bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300"
  } %}
  
  <span class="inline-flex items-center rounded-full font-medium {{ size_classes[size] }} {{ tone_classes[tone] }} {{ class }}">
    {{ text }}
  </span>
{% endmacro %}

{# Table Component #}
{% macro Table(columns, rows, empty="No data", compact=False, class="") %}
  {% set table_class = "min-w-full divide-y divide-gray-200 dark:divide-gray-700 " + class %}
  {% set cell_class = "px-6 py-3" if not compact else "px-4 py-2" %}
  
  <div class="overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg">
    <table class="{{ table_class }}">
      <thead class="bg-gray-50 dark:bg-gray-800">
        <tr>
          {% for column in columns %}
            <th class="{{ cell_class }} text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
              {{ column }}
            </th>
          {% endfor %}
        </tr>
      </thead>
      <tbody class="bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-700">
        {% if rows %}
          {% for row in rows %}
            <tr class="hover:bg-gray-50 dark:hover:bg-gray-800">
              {% for cell in row %}
                <td class="{{ cell_class }} text-sm text-gray-900 dark:text-white">
                  {{ cell | safe }}
                </td>
              {% endfor %}
            </tr>
          {% endfor %}
        {% else %}
          <tr>
            <td colspan="{{ columns | length }}" class="{{ cell_class }} text-center text-sm text-gray-500 dark:text-gray-400">
              {{ empty }}
            </td>
          </tr>
        {% endif %}
      </tbody>
    </table>
  </div>
{% endmacro %}

{# Field Component #}
{% macro Field(label, value=None, name=None, type="text", help=None, readonly=False, placeholder="", required=False, class="", **kwargs) %}
  <div class="space-y-2 {{ class }}">
    {% if label %}
      <label class="block text-sm font-medium text-gray-700 dark:text-gray-300">
        {{ label }}
        {% if required %}<span class="text-red-500">*</span>{% endif %}
      </label>
    {% endif %}
    
    {% if readonly %}
      <div class="px-3 py-2 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-md text-sm text-gray-900 dark:text-white">
        {{ value or placeholder }}
      </div>
    {% else %}
      <input 
        type="{{ type }}" 
        {% if name %}name="{{ name }}"{% endif %}
        {% if value %}value="{{ value }}"{% endif %}
        {% if placeholder %}placeholder="{{ placeholder }}"{% endif %}
        {% if required %}required{% endif %}
        class="block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-800 dark:text-white"
        {% for key, val in kwargs.items() %}{{ key }}="{{ val }}"{% endfor %}
      >
    {% endif %}
    
    {% if help %}
      <p class="text-xs text-gray-500 dark:text-gray-400">{{ help }}</p>
    {% endif %}
  </div>
{% endmacro %}

{# Section Component #}
{% macro Section(title, actions=None, body="", class="") %}
  <section class="space-y-4 {{ class }}">
    {% if title or actions %}
      <div class="flex items-center justify-between">
        {% if title %}<h2 class="text-lg font-semibold text-gray-900 dark:text-white">{{ title }}</h2>{% endif %}
        {% if actions %}
          <div class="flex items-center gap-2">
            {% for action in actions %}{{ action }}{% endfor %}
          </div>
        {% endif %}
      </div>
    {% endif %}
    {% if body %}<div class="text-gray-600 dark:text-gray-300">{{ body | safe }}</div>{% endif %}
  </section>
{% endmacro %}

{# Loading Skeleton #}
{% macro Skeleton(width="100%", height="1rem", class="") %}
  <div class="animate-pulse bg-gray-200 dark:bg-gray-700 rounded {{ class }}" style="width: {{ width }}; height: {{ height }};"></div>
{% endmacro %}

{# Divider #}
{% macro Divider(text=None, class="") %}
  <div class="relative {{ class }}">
    <div class="absolute inset-0 flex items-center">
      <div class="w-full border-t border-gray-300 dark:border-gray-600"></div>
    </div>
    {% if text %}
      <div class="relative flex justify-center text-sm">
        <span class="px-2 bg-white dark:bg-gray-900 text-gray-500 dark:text-gray-400">{{ text }}</span>
      </div>
    {% endif %}
  </div>
{% endmacro %}

{# Alert #}
{% macro Alert(message, type="info", dismissible=False, class="") %}
  {% set type_classes = {
    "info": "bg-blue-50 border-blue-200 text-blue-800 dark:bg-blue-900 dark:border-blue-700 dark:text-blue-300",
    "success": "bg-green-50 border-green-200 text-green-800 dark:bg-green-900 dark:border-green-700 dark:text-green-300",
    "warning": "bg-yellow-50 border-yellow-200 text-yellow-800 dark:bg-yellow-900 dark:border-yellow-700 dark:text-yellow-300",
    "danger": "bg-red-50 border-red-200 text-red-800 dark:bg-red-900 dark:border-red-700 dark:text-red-300"
  } %}
  
  <div class="border rounded-md p-4 {{ type_classes[type] }} {{ class }}">
    <div class="flex">
      <div class="flex-1">{{ message | safe }}</div>
      {% if dismissible %}
        <button type="button" class="ml-2 text-current opacity-50 hover:opacity-75" onclick="this.parentElement.parentElement.remove()">
          <span class="sr-only">Dismiss</span>
          <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
          </svg>
        </button>
      {% endif %}
    </div>
  </div>
{% endmacro %}

{% endblock %}
